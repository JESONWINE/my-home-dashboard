å®¶åº­æ§åˆ¶é¢æ¿å¼€å‘è·¯å¾„è§„åˆ’æ–‡æ¡£

æœ¬ç« èŠ‚è¯¦ç»†åˆ—å‡ºæ•´ä¸ª React + Vite é¡¹ç›®ä»å¼€å‘åˆ°éƒ¨ç½²çš„é˜¶æ®µè·¯å¾„ï¼Œç»“åˆæµç¨‹å›¾å’Œæ“ä½œè¯´æ˜ï¼Œä¾¿äºé€æ­¥å¼€å‘ä¸è®°å½•å½“å‰è¿›åº¦ã€‚

ä¸€ã€å¼€å‘è·¯å¾„æµç¨‹å›¾ï¼ˆæ–‡å­—ç‰ˆï¼‰

1. ç¡®è®¤å¼€å‘ç¯å¢ƒå‡†å¤‡
   â†“
2. åˆå§‹åŒ–é¡¹ç›®å‰ç«¯ç»“æ„
   â†“
3. ç¼–å†™é¡µé¢æ¡†æ¶ï¼ˆReact + Ant Designï¼‰
   â†“
4. æ·»åŠ æœåŠ¡å…¥å£ï¼ˆåµŒå…¥ iframe / è·¯ç”±ç»„ä»¶ï¼‰
   â†“
5. æ¥å…¥åç«¯æœåŠ¡ APIï¼ˆClashã€Alistã€DDNS-Goï¼‰
   â†“
6. å®ç°äº¤äº’åŠŸèƒ½ï¼ˆåˆ‡æ¢èŠ‚ç‚¹ã€åŒæ­¥ DDNS ç­‰ï¼‰
   â†“
7. æœ¬åœ°æ„å»ºç”Ÿäº§ç‰ˆæœ¬
   â†“
8. å°†æ„å»ºç»“æœéƒ¨ç½²åˆ°å®¶åº­æœåŠ¡å™¨
   â†“
9. å±€åŸŸç½‘è®¿é—®æ§åˆ¶é¢æ¿é¡µé¢

äºŒã€æ¯é˜¶æ®µä»»åŠ¡è¯´æ˜

âœ… ç¬¬ 1 é˜¶æ®µï¼šç¯å¢ƒå‡†å¤‡

ğŸ’¡ ä»£ç†ç¯å¢ƒä¸‹çš„ CMD è®¾ç½®ï¼ˆå¯é€‰ï¼‰

è‹¥ä½ æœ¬æœºå¯ç”¨äº† Clash æˆ–å…¶ä»–æœ¬åœ°ä»£ç†å·¥å…·ï¼ˆå¦‚ 127.0.0.1:7890ï¼‰ï¼Œå»ºè®®é…ç½®å‘½ä»¤è¡Œä»£ç†ï¼Œç¡®ä¿ npmã€git ç­‰å‘½ä»¤èµ°ä»£ç†ï¼Œæå‡ç¨³å®šæ€§å’Œé€Ÿåº¦ã€‚

âœ… æ–¹æ³•ä¸€ï¼šä¸´æ—¶è®¾ç½®ï¼ˆä»…å½“å‰çª—å£æœ‰æ•ˆï¼‰
åœ¨ CMD ä¸­è¾“å…¥ï¼š

set http_proxy=http://127.0.0.1:7890
set https_proxy=http://127.0.0.1:7890

âœ… æ–¹æ³•äºŒï¼šæ°¸ä¹…è®¾ç½®ï¼ˆç³»ç»Ÿç¯å¢ƒå˜é‡ï¼‰

æ‰“å¼€ç³»ç»Ÿè®¾ç½® â†’ é«˜çº§ â†’ ç¯å¢ƒå˜é‡

åœ¨â€œç”¨æˆ·å˜é‡â€æˆ–â€œç³»ç»Ÿå˜é‡â€ä¸­æ–°å»ºï¼š

å˜é‡åï¼šhttp_proxy

å˜é‡å€¼ï¼šhttp://127.0.0.1:7890

å†æ·»åŠ ä¸€é¡¹ï¼š

å˜é‡åï¼šhttps_proxy

å˜é‡å€¼ï¼šhttp://127.0.0.1:7890

ç¡®å®šåå…³é—­ CMDï¼Œé‡æ–°æ‰“å¼€å³å¯ç”Ÿæ•ˆ

âœ… éªŒè¯æ˜¯å¦æˆåŠŸï¼š

echo %http_proxy%
npm ping

å¦‚æœ npm ping è¿”å› OKï¼Œè¯´æ˜ä»£ç†å·²æ­£å¸¸å¯ç”¨ã€‚

å®‰è£… Node.js â‰¥ 18ï¼ˆå¦‚ v18.16.1 âœ…ï¼‰

å®‰è£… Gitï¼ˆå¦‚ v2.41.0 âœ…ï¼‰

å®‰è£… VS Code å’Œæ’ä»¶ï¼ˆESLintã€Prettierã€GitLens ç­‰ï¼‰

æ³¨å†Œå¹¶ç™»å½• GitHubï¼ˆå»ºè®®é…ç½® SSHï¼‰

âœ… ç¬¬ 2 é˜¶æ®µï¼šåˆå§‹åŒ–å‰ç«¯é¡¹ç›®ç»“æ„ï¼ˆè¿›è¡Œä¸­ ğŸš§ï¼‰

ğŸ“ é¡¹ç›®æ ¹ç›®å½•ç»“æ„è¯´æ˜

ä»¥ä¸‹æ˜¯ Vite + React åˆ›å»ºçš„é¡¹ç›®ç»“æ„ç®€è¦è¯´æ˜ï¼š

æ–‡ä»¶/æ–‡ä»¶å¤¹

ç±»å‹

è¯´æ˜

node_modules/

æ–‡ä»¶å¤¹

å­˜æ”¾æ‰€æœ‰ npm å®‰è£…çš„ä¾èµ–æ¨¡å—ï¼Œç”± npm install è‡ªåŠ¨ç”Ÿæˆ

public/

æ–‡ä»¶å¤¹

é™æ€èµ„æºç›®å½•ï¼Œé‡Œé¢çš„æ–‡ä»¶åœ¨æ„å»ºåä¼šåŸæ ·å¤åˆ¶åˆ°æœ€ç»ˆè¾“å‡ºä¸­

src/

æ–‡ä»¶å¤¹

é¡¹ç›®æºç ç›®å½•ï¼ŒReact ç»„ä»¶ã€æ ·å¼ã€é€»è¾‘ä»£ç éƒ½æ”¾åœ¨è¿™é‡Œ

.gitignore

æ–‡ä»¶

Git å¿½ç•¥é…ç½®ï¼Œä¸è·Ÿè¸ªå…¶ä¸­åˆ—å‡ºçš„æ–‡ä»¶ï¼ˆå¦‚ node_modulesï¼‰

eslint.config.js

æ–‡ä»¶

ESLint é…ç½®æ–‡ä»¶ï¼Œç”¨äºå®šä¹‰ä»£ç é£æ ¼æ£€æŸ¥è§„åˆ™

index.html

æ–‡ä»¶

å…¥å£ HTML æ–‡ä»¶ï¼Œæœ€ç»ˆæ„å»ºé¡µé¢åŸºäºæ­¤æ¨¡æ¿æ³¨å…¥ React åº”ç”¨

package.json

æ–‡ä»¶

é¡¹ç›®é…ç½®ä¸ä¾èµ–å£°æ˜æ ¸å¿ƒæ–‡ä»¶ï¼Œå®šä¹‰åç§°ã€ç‰ˆæœ¬ã€å‘½ä»¤ç­‰

package-lock.json

æ–‡ä»¶

é”å®šä¾èµ–ç‰ˆæœ¬ï¼Œç¡®ä¿å›¢é˜Ÿæˆå‘˜å®‰è£…ä¸€è‡´ç‰ˆæœ¬çš„ä¾èµ–

README.md

æ–‡ä»¶

é¡¹ç›®è¯´æ˜æ–‡æ¡£ï¼ˆå¯é€‰ç¼–è¾‘ï¼‰

vite.config.js

æ–‡ä»¶

Vite é¡¹ç›®é…ç½®æ–‡ä»¶ï¼Œå¦‚è®¾ç½®è·¯å¾„åˆ«åã€ä»£ç†ç­‰

ğŸ’¡ é€šå¸¸ä½ ä¸»è¦å…³æ³¨ src/ ç›®å½•ï¼Œç”¨äºæ—¥å¸¸å¼€å‘ç»„ä»¶ä¸é¡µé¢é€»è¾‘ã€‚

ğŸ“ src/ å­ç›®å½•ç»“æ„è¯´æ˜

ä»¥ä¸‹æ˜¯ src/ æ–‡ä»¶å¤¹ä¸­çš„ä¸»è¦å†…å®¹ï¼š

æ–‡ä»¶/æ–‡ä»¶å¤¹

ç±»å‹

è¯´æ˜



assets/

æ–‡ä»¶å¤¹

å­˜æ”¾å›¾åƒã€å›¾æ ‡ç­‰é™æ€èµ„æºï¼Œå¯åœ¨ç»„ä»¶ä¸­å¼•ç”¨



App.jsx

æ–‡ä»¶

åº”ç”¨ä¸»ç»„ä»¶ï¼Œé¡µé¢ç»“æ„ã€è·¯ç”±æˆ–ä¸»è¦é€»è¾‘å…¥å£



App.css

æ–‡ä»¶

App ç»„ä»¶çš„æ ·å¼å®šä¹‰ï¼Œå¯ç›´æ¥æˆ–é—´æ¥å¼•å…¥ä½¿ç”¨



index.css

æ–‡ä»¶

å…¨å±€ CSS æ ·å¼æ–‡ä»¶ï¼Œé€šå¸¸ç”¨äºé‡ç½®é»˜è®¤æ ·å¼ç­‰



main.jsx

æ–‡ä»¶

React åº”ç”¨å…¥å£æ–‡ä»¶ï¼Œè´Ÿè´£æŒ‚è½½ App åˆ° HTML ä¸­çš„ root å…ƒç´ ï¼Œå¹¶å¼•å…¥å…¨å±€æ ·å¼ç­‰å¹¶å¼•å…¥å…¨å±€æ ·å¼ç­‰



ğŸ’¡ è‹¥é‡ CERT_HAS_EXPIRED é”™è¯¯ï¼Œå¯èƒ½æ˜¯æ·˜å®é•œåƒè¯ä¹¦è¿‡æœŸï¼Œè¯·æ‰§è¡Œä»¥ä¸‹å‘½ä»¤åˆ‡æ¢å›å®˜æ–¹æºæˆ–æ–°çš„æ·˜å®é•œåƒæºï¼š

npm config set registry https://registry.npmjs.org
# æˆ–
npm config set registry https://registry.npmmirror.com

æˆ–ä¸´æ—¶ä½¿ç”¨å®˜æ–¹æºæ‰§è¡Œå‘½ä»¤ï¼š

npx --registry=https://registry.npmjs.org create-vite@latest my-home-dashboard --template react

è¿›å…¥å¼€å‘ç›®å½•ï¼š

cd D:\Projects

åˆ›å»º Vite é¡¹ç›®ï¼ˆReact æ¨¡æ¿ï¼‰ï¼š

npm create vite@latest my-home-dashboard --template react

è¿›å…¥ç›®å½•å¹¶å®‰è£…ä¾èµ–ï¼š

# âš ï¸ å¦‚æœé¡¹ç›®åˆ›å»ºåœ¨é”™è¯¯è·¯å¾„ï¼Œå¯ä»¥åˆ é™¤åŸç›®å½•å¹¶é‡æ–°æ‰§è¡Œä¸Šä¸€æ­¥å‘½ä»¤
cd my-home-dashboard
npm install

è¿è¡Œå¼€å‘æœåŠ¡å™¨ï¼š

npm run dev

æµè§ˆå™¨è®¿é—®ï¼šhttp://localhost:5173

ğŸ’¡ å½“å‰å®‰è£…æ—¥å¿—æç¤ºéƒ¨åˆ†ä¾èµ–ï¼ˆå¦‚ eslintï¼‰æ¨èæ›´é«˜ç‰ˆæœ¬ Node.jsï¼ˆ>=18.18ï¼‰ï¼Œä½†è¿™ä¸ä¼šå½±å“ Viteã€React æˆ–é¡µé¢åŠŸèƒ½çš„æ­£å¸¸è¿è¡Œã€‚å³ä½¿ eslint åŠŸèƒ½éƒ¨åˆ†ä¸å¯ç”¨æˆ–æç¤ºè­¦å‘Šï¼Œä¹Ÿä¸ä¼šé˜»æ­¢å¼€å‘ä¸æ„å»ºæµç¨‹ï¼Œå› æ­¤å¯æ”¾å¿ƒå¿½ç•¥ç»§ç»­å¼€å‘ã€‚

ğŸ’¡ è¡¥å……ï¼šVS Code ä¹Ÿå†…ç½®ç»ˆç«¯ï¼Œå¯ä»¥ä»£æ›¿ç³»ç»Ÿ CMD æ‰§è¡Œé¡¹ç›®å‘½ä»¤ã€‚

å¿«æ·é”®ï¼š`Ctrl + ``ï¼ˆåå¼•å·ï¼‰

æˆ–ç‚¹å‡»é¡¶éƒ¨èœå•æ â€œç»ˆç«¯ > æ–°ç»ˆç«¯â€

å¯ç›´æ¥åœ¨ç»ˆç«¯ä¸­è¿è¡Œ npm installã€npm run dev ç­‰å‘½ä»¤

âœ… ç¬¬ 3 é˜¶æ®µï¼šé¡µé¢ç»“æ„å¼€å‘ï¼ˆå¼€å§‹å‡†å¤‡ï¼‰

é¡µé¢ç»“æ„ç›®æ ‡

æ„å»ºä¸€ä¸ªåŸºç¡€å¸ƒå±€é¡µé¢ï¼ŒåŒ…å«å·¦ä¾§èœå•ï¼ˆSiderï¼‰ã€é¡¶éƒ¨æ ï¼ˆHeaderï¼‰å’Œä¸­é—´å†…å®¹åŒºåŸŸï¼ˆContentï¼‰ï¼Œç”¨äºåç»­åµŒå…¥ iframe æˆ–æ›¿æ¢ä¸ºç»„ä»¶ã€‚

ğŸ’¡ è¿è¡Œ npm run dev åè®¿é—® http://localhost:5173ï¼Œå¦‚æœä½ çœ‹åˆ° â€œVite + Reactâ€ çš„æ¬¢è¿é¡µé¢ï¼ˆå¸¦æœ‰ç‚¹å‡»è®¡æ•°æŒ‰é’®å’Œä¸¤ä¸ª Logoï¼‰ï¼Œè¯´æ˜å¼€å‘ç¯å¢ƒå·²æˆåŠŸå¯åŠ¨ï¼ŒReact å·²æ­£ç¡®åŠ è½½ï¼Œæ¥ä¸‹æ¥å¯ä»¥å¼€å§‹æ›¿æ¢é»˜è®¤å†…å®¹ä¸ºä½ çš„æ§åˆ¶å°é¡µé¢ç»“æ„ã€‚

âœ… é¡µé¢å¼€å‘å‡†å¤‡ï¼š

å®‰è£… Ant Design

npm install antd

åœ¨ main.jsx ä¸­å¼•å…¥æ ·å¼ï¼ˆå®Œæ•´ç¤ºä¾‹ï¼‰ï¼š

import 'antd/dist/reset.css'

import React from 'react';
import ReactDOM from 'react-dom/client';
import App from './App.jsx';
import 'antd/dist/reset.css';
import './index.css';

ReactDOM.createRoot(document.getElementById('root')).render(
  <React.StrictMode>
    <App />
  </React.StrictMode>
);

æ‰“å¼€ App.jsx æ–‡ä»¶ï¼Œå‡†å¤‡æ’å…¥é¡µé¢ç»“æ„ç»„ä»¶ã€‚

ä½¿ç”¨ Ant Design çš„ Layout æ„å»ºåŸºç¡€é¡µé¢ç»“æ„ï¼š

å®ç°å¯¼èˆªåˆ‡æ¢èœå•

åˆæœŸåµŒå…¥ iframeï¼šAlistã€DDNS-Goã€Clash æ§åˆ¶å°

ç¤ºä¾‹é¡µé¢ç»“æ„ä»£ç ï¼ˆæ’å…¥ App.jsxï¼‰

import { Layout, Menu } from 'antd';
import { useState } from 'react';

const { Header, Sider, Content } = Layout;

function App() {
  const [current, setCurrent] = useState('alist');

  const urlMap = {
    alist: 'http://localhost:5244',
    ddnsgo: 'http://localhost:9876',
    clash: 'http://localhost:9090',
  };

  return (
    <Layout style={{ height: '100vh' }}>
      <Sider>
        <Menu
          theme="dark"
          mode="inline"
          selectedKeys={[current]}
          onClick={({ key }) => setCurrent(key)}
          items={[
            { key: 'alist', label: 'Alist' },
            { key: 'ddnsgo', label: 'DDNS-Go' },
            { key: 'clash', label: 'Clash æ§åˆ¶å°' },
          ]}
        />
      </Sider>
      <Layout>
        <Header style={{ color: 'white' }}>å®¶åº­æ§åˆ¶é¢æ¿</Header>
        <Content>
          <iframe
            src={urlMap[current]}
            style={{ width: '100%', height: 'calc(100vh - 64px)', border: 'none' }}
          />
        </Content>
      </Layout>
    </Layout>
  );
}

export default App;

ç¬¬ 4 é˜¶æ®µï¼šAPI æ¥å…¥ä¸äº¤äº’é€»è¾‘

ä½¿ç”¨ Axios è°ƒç”¨åç«¯æœåŠ¡ HTTP APIï¼š

Clashï¼šè·å–èŠ‚ç‚¹ã€åˆ‡æ¢ç­–ç•¥ã€æµé‡çŠ¶æ€

Alistï¼šè¯»å–ç›®å½•æ ‘æˆ–æ–‡ä»¶ä¿¡æ¯

DDNS-Goï¼šæ‰§è¡Œåˆ·æ–°åŸŸåè§£æè®°å½•ç­‰

ç¬¬ 5 é˜¶æ®µï¼šæ„å»ºå‘å¸ƒç‰ˆæœ¬

npm run build

è¾“å‡ºç›®å½•ä¸ºï¼šdist/

ç¬¬ 6 é˜¶æ®µï¼šéƒ¨ç½²è‡³å®¶åº­æœåŠ¡å™¨

æ–¹å¼ä¸€ï¼šSCP ä¸Šä¼ 

scp -r dist/ jason@192.168.2.1:/home/jason/dashboard

æ–¹å¼äºŒï¼šGit æ‹‰å–æ›´æ–°

# æœ¬åœ° push
npm run build
git add .
git commit -m "build"
git push

# æœåŠ¡å™¨æ‰§è¡Œï¼š
cd /home/jason/home-dashboard
git pull
cp -r dist/* /home/jason/dashboard/

ç¬¬ 7 é˜¶æ®µï¼šNginx é…ç½®ä¸è®¿é—®é¡µé¢

é…ç½®ç¤ºä¾‹ï¼š

server {
    listen 80;
    server_name dashboard.madtechlab.local;

    location / {
        root /home/jason/dashboard;
        index index.html;
        try_files $uri $uri/ /index.html;
    }

    location /alist/ {
        proxy_pass http://localhost:5244/;
    }

    location /ddnsgo/ {
        proxy_pass http://localhost:9876/;
    }

    location /clash/ {
        proxy_pass http://localhost:9090/;
    }
}

è®¿é—®æ–¹å¼ï¼š

æµè§ˆå™¨è®¿é—® http://dashboard.madtechlab.local

å±€åŸŸç½‘è®¾å¤‡éœ€é…ç½® hosts æˆ– DNS è§£æ

æ¥ä¸‹æ¥å¯è¿›å…¥ç»„ä»¶è®¾è®¡ã€API å°è£…é˜¶æ®µï¼Œé€æ­¥æ›¿æ¢ iframeï¼Œæ‰“é€ äº¤äº’å¼æ§åˆ¶ä¸­å¿ƒã€‚

